# Generated by Django 3.2.13 on 2022-12-11 18:57

from django.db import migrations

"""
Same problem as with 0009_create_and_populate_actor_new_field.py migration

use this mysql statement to populate film field:

UPDATE film_actor INNER JOIN film on film_actor.film_old = film.film_id SET film_actor.film_id = film.film_uuid;
"""


def populate_film_field(apps, schema_editor):

    Film = apps.get_model("movies_app", "Film")
    FilmActor = apps.get_model("movies_app", "FilmActor")

    for film_actor in FilmActor.objects.all():
        film_actor.film = Film.objects.get(film_id=film_actor.film_old)
        film_actor.save()


class Migration(migrations.Migration):

    dependencies = [
        ('movies_app', '0015_populate_film_field_of_filmcategory_model'),
    ]

    operations = [
        # this functions corrupts data, see details in the comments above
        # migrations.RunPython(populate_film_field, reverse_code=migrations.RunPython.noop),
    ]
